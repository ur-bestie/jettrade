{% extends 'user/base.html' %}
{% load static %}
{% block content %}



{% if active.status %}
<!-- <div class="container mb-5">
    <div class="pform">
        <form action="" method="POST">
            {% csrf_token %}
        <div class="actionbtn">
            <a href="#" style="border-bottom: 3px solid dodgerblue;padding-bottom: 10px;color: dodgerblue;">Buy Coin</a>
             <a href="/cryptosell">Sell Coin</a>
        </div><br>
        <h1>What Do you Want To Buy?</h1>
        <label for="">choose what you want to buy </label>
        <div class="selectopt">
            <select style="background-color: white;" id="productSelect" name="c_id" data-placeholder="Select a country" data-dynamic-select>
                {% for x in x %}
                <option value="{{x.id}}" data-img="{{x.logo.url}}" >{{x.name}}</option>
                
                {% endfor %}
            </select>
        </div><br>
        <label for="inputam">Amount To Buy $</label><br>
        <input class="aminput" name="amount" type="number" id="inputam" placeholder=" $1,000">
        <p>Rate In Naira: <span id="rate">{{sinfo.crypto_buying_rate}}</span></p>
        <div class="pamount">
            <p>Payment: <span id="payment">0.00</span></p>
            <input hidden type="number" name="payment" id="paymentInput">
            <input hidden type="number" name="rate_naira" value="{{sinfo.crypto_buying_rate}}">
        </div>
        <label for="inputam">Your Receiving Wallet Address</label><br>
        <input class="aminput" type="text" name="receiving_address" id="inputam" placeholder="">
    <label for="">choose Payment Method </label>
        <div class="selectopt">
        <select style="background-color: white;" id="country" name="p_id" data-placeholder="Select a country" data-dynamic-select>
           {% for p in pg %}
            <option value="{{p.id}}" data-img="{{p.logo.url}}">{{p.name}}</option>
            {% endfor %}
        </select><br><br>
    <div class="btn">
        <button type="submit" style="background-color: dodgerblue;width: 100%;" class="btn text-white text-uppercase fs-7" type="submit">Continue to Buy</button>
    </div>
    </form>
    </div>
    
</div>

<p id="rateDisplay"></p>
<p id="quantityDisplay"></p> -->

<!-- <div class="paymentopt">
    <label for="">Payment method</label><br>
    <div class="chopt" style="display: flex;">
        <div class="content"> <input type="checkbox" name="" id="checkbox1" onclick="uncheckOthers('checkbox1')"> PAYPAL</div>
         <img width="20" src="{% static 'user/images/coin/ETH.png' %}" alt="">
     </div>

    <div class="chopt" style="display: flex;">
       <div class="content"> <input type="checkbox" name="" id="checkbox2" onclick="uncheckOthers('checkbox2')"> BANK TRANSFER</div>
        <img width="20" src="{% static 'user/images/coin/ETH.png' %}" alt="">
    </div>
 </div> -->
 


    <div class="card card-style">
        <div class="content mb-0">
        <div class="tabs tabs-pill" id="tab-group-2">
        <div class="tab-controls rounded-m p-1 overflow-visible">
        <a class="font-13 rounded-s py-1 shadow-bg shadow-bg-s" data-bs-toggle="collapse" href="#tab-4" aria-expanded="true">Buy crypto</a>
        <a class="font-13 rounded-s py-1 shadow-bg shadow-bg-s" data-bs-toggle="collapse" href="#tab-5" aria-expanded="false">Sell crypto</a>
        </div>
        <div class="mt-3"></div>
        
        <div class="collapse show" id="tab-4" data-bs-parent="#tab-group-2">
        
            <form action="" method="POST">
                {% csrf_token %}
                 <div class="pt-3"></div>
                <div class="form-custom form-label form-icon">
                <i class="bi bi-bank font-13"></i>
                 <select class="form-select rounded-xs"  name="c_id" id="c6">
                <option value="0" disabled selected>Select Coin</option>
                {% for x in x %}
                <option  value="{{x.id}}" data-img="{{p.logo.url}}">{{x.name}}</option>
                {% endfor %}
                </select>
                 </div>
               
                <div class="pb-2"></div>
                <div class="form-custom form-label form-icon">
                    <i class="bi bi-currency-dollar font-14"></i>
                <input name="amount" required type="number" id="inputam" step="0.01" class="form-control rounded-xs" id="c31" placeholder="Amount To Buy in $" />
                <label for="c31" class="color-highlight form-label-always-">Amount To Buy in $</label>
                <span>(required)</span>
                </div>
                <div class="am" style="display: flex;justify-content: space-between;padding: 10px;"><p>Rate In Naira: <span id="rate">{{sinfo.crypto_buying_rate}}</span></p>
                    <div class="pamount">
                        <p>Payment: <span id="payment">N0.00</span></p>
                        <input type="hidden" name="payment" id="paymentInput">
                        <input hidden type="number" name="rate_naira" value="{{sinfo.crypto_buying_rate}}">
                    </div></div>
                <div class="pb-2"></div>
                <div class="form-custom form-label form-icon">
                <i class="bi bi-wallet font-14"></i>
                <input type="text" required name="receiving_address" class="form-control rounded-xs" id="c32" placeholder="Receiving Wallet Address" />
                <label for="c32" class="color-highlight form-label-always-">Receiving Wallet Address</label>
                <span>(required)</span>
                </div>  
                <div class="pb-3"></div>
                <button type="submit" class="btn w-100 btn-full gradient-green rounded-s shadow-bg shadow-bg-s mb-4">Buy Now</button>
                
            </form>
        </div>
        
        <div class="collapse" id="tab-5" data-bs-parent="#tab-group-2">
        <div class="pt-3"></div>
        <form action="/cryptosell" method="POST">
            {% csrf_token %}
             <div class="pt-3"></div>
            <div class="form-custom form-label form-icon">
            <i class="bi bi-bank font-13"></i>
             <select class="form-select rounded-xs"  name="c_id" id="c6">
            <option value="0" disabled selected>Select Coin</option>
            {% for x in x %}
            <option  value="{{x.id}}" data-img="{{p.logo.url}}">{{x.name}}</option>
            {% endfor %}
            </select>
             </div>
           
            <div class="pb-2"></div>
            <div class="form-custom form-label form-icon">
                <i class="bi bi-currency-dollar font-14"></i>
            <input name="amount" type="number" required id="inputam1" step="0.01" class="form-control rounded-xs" id="c31" placeholder="Amount To Buy in $" />
            <label for="c31" class="color-highlight form-label-always-">Amount To Buy in $</label>
            <span>(required)</span>
            </div>
            <div class="am" style="display: flex;justify-content: space-between;padding: 10px;"><p>Rate In Naira: <span id="rate1">{{sinfo.crypto_selling_rate}}</span></p>
                <div class="pamount">
                    <p>Payment: <span id="payment1">N0.00</span></p>
                    <input type="hidden" name="payment" id="paymentInput1">
                    <input hidden type="number" name="rate_naira" value="{{sinfo.crypto_buying_rate}}">
                </div></div>
            <div class="pb-2"></div>
            <div class="d-flex" style="justify-content: space-between;">
            <i class="bi bi-wallet font-14"></i>
            <label for="c32" class="color-highlight form-label-always-">Enter Your Bank Info For Payment</label>
            <span>(required)</span>
            </div>  
            <div class="pb-2"></div>
            <textarea name="payment_info" id="" style="width: 100%;height:10rem ;border-radius: 5px;padding: 1rem;">
            Bank: 
            Bank Name: 
            Bank Account Number: 
                        </textarea>
            <div class="pb-3"></div>
            <button type="submit" class="btn w-100 btn-full gradient-green rounded-s shadow-bg shadow-bg-s mb-4">Continue</button>
            
        </form>
        </div>
        
 <script>
   document.addEventListener('DOMContentLoaded', function() {
    // Your existing code here

    // Get references to the input field, paragraph tags, and payment input field
    const inputField = document.getElementById('inputam');
    const rateSpan = document.getElementById('rate');
    const paymentSpan = document.getElementById('payment');
    const paymentInput = document.getElementById('paymentInput');

    // Add event listener to the input field to detect changes
    inputField.addEventListener('input', function() {
        // Retrieve the value from the input field and the rate from the paragraph tag
        const inputValue = parseFloat(inputField.value);
        const rateValue = parseFloat(rateSpan.innerText.replace(/[^\d.-]/g, ''));

        // Check if inputValue and rateValue are valid numbers
        if (!isNaN(inputValue) && !isNaN(rateValue)) {
            // Perform the multiplication
            const payment = inputValue * rateValue;

            // Update the content of the payment paragraph tag
            paymentSpan.innerText = 'N' + payment.toFixed(2);

            // Update the value of the payment input field
            paymentInput.value = payment.toFixed(2);
        } else {
            paymentSpan.innerText = 'N0.00'; // Reset to default if input is invalid
            paymentInput.value = ''; // Clear the hidden input if input is invalid
        }
    });

    // Same logic for the second form
    const inputField1 = document.getElementById('inputam1');
    const rateSpan1 = document.getElementById('rate1');
    const paymentSpan1 = document.getElementById('payment1');
    const paymentInput1 = document.getElementById('paymentInput1');

    inputField1.addEventListener('input', function() {
        const inputValue = parseFloat(inputField1.value);
        const rateValue = parseFloat(rateSpan1.innerText.replace(/[^\d.-]/g, ''));

        if (!isNaN(inputValue) && !isNaN(rateValue)) {
            const payment = inputValue * rateValue;

            paymentSpan1.innerText = 'N' + payment.toFixed(2);
            paymentInput1.value = payment.toFixed(2);
        } else {
            paymentSpan1.innerText = 'N0.00';
            paymentInput1.value = '';
        }
    });
});

</script>

{% else %}
    <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(function() {
                window.location.href = '/kyc';
            }, 1); // 1000 milliseconds = 1 second
        });
    </script>
{% endif %}


{% endblock %}